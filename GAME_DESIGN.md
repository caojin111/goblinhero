# 🎮 幸运房东 - 游戏设计文档 (GDD)

## 一、游戏概述

### 1.1 游戏定位
- **类型**: Roguelite + 策略构筑 + 老虎机
- **平台**: iOS
- **核心玩法**: 老虎机旋转 + 符号收集 + 房租挑战
- **目标玩家**: 喜欢策略构筑和轻度Roguelike的玩家

### 1.2 游戏核心循环
```
旋转老虎机 → 获取金币 → 支付房租 → 选择符号 → 强化符号池 → 下一回合
```

## 二、核心游戏机制

### 2.1 老虎机系统

#### 基础规则
- **格子数量**: 20个格子（5列 × 4行）
- **符号来源**: 从玩家符号池中随机抽取
- **旋转次数**: 每回合10次旋转
- **收益计算**: 所有符号收益总和

#### 符号出现机制 ⭐️ **重要更新**
```swift
// 符号池大小直接决定显示数量
// 3个符号池 → 显示3个符号，17个空格子
// 6个符号池 → 显示6个符号，14个空格子
// 10个符号池 → 显示10个符号，10个空格子
// 20个符号池 → 显示20个符号，0个空格子

// 权重分配：相同符号在池中数量越多，出现概率越高
// 例如：符号池有4种符号（2个苹果，1个香蕉，1个金币）
// 显示结果：4个符号，16个空格子
// 苹果权重 = 2，出现概率 = 50%
// 香蕉/金币权重 = 1，出现概率 = 25%
```

### 2.2 符号系统

#### 符号属性
```swift
struct Symbol {
    - name: String          // 符号名称
    - icon: String          // 图标（emoji）
    - baseValue: Int        // 基础收益
    - rarity: SymbolRarity  // 稀有度
    - type: SymbolType      // 符号类型
    - description: String   // 描述
}
```

#### 符号分类

**水果类 (Fruit)**
| 符号 | 名称 | 基础收益 | 稀有度 | 特性 |
|------|------|----------|--------|------|
| 🍎 | 苹果 | 2 | 普通 | 基础收益 |
| 🍌 | 香蕉 | 2 | 普通 | 基础收益 |
| 🍊 | 橙子 | 2 | 普通 | 基础收益 |
| 🍇 | 葡萄 | 3 | 普通 | 中等收益 |
| 🍉 | 西瓜 | 4 | 稀有 | 高收益 |

**金币类 (Coin)**
| 符号 | 名称 | 基础收益 | 稀有度 | 特性 |
|------|------|----------|--------|------|
| 🪙 | 铜币 | 1 | 普通 | 最低收益 |
| 💰 | 银币 | 3 | 普通 | 稳定收益 |
| 💎 | 金币 | 5 | 稀有 | 高收益 |
| 💼 | 宝箱 | 8 | 史诗 | 超高收益 |

**动物类 (Animal)**
| 符号 | 名称 | 基础收益 | 稀有度 | 特性 |
|------|------|----------|--------|------|
| 🐝 | 蜜蜂 | 2 | 普通 | 与水果协同 |
| 🐰 | 兔子 | 3 | 稀有 | 幸运加成 |
| 🐱 | 小猫 | 4 | 稀有 | 高收益 |

**特殊类 (Special)**
| 符号 | 名称 | 基础收益 | 稀有度 | 特性 |
|------|------|----------|--------|------|
| 🍀 | 幸运草 | 5 | 史诗 | 幸运效果 |
| ⭐️ | 星星 | 7 | 史诗 | 高收益 |
| 💎 | 钻石 | 10 | 传说 | 最高收益 |

#### 稀有度系统
```
普通 (Common)   - 灰色 - 50% 出现概率
稀有 (Rare)     - 蓝色 - 30% 出现概率
史诗 (Epic)     - 紫色 - 15% 出现概率
传说 (Legendary) - 橙色 - 5% 出现概率
```

### 2.3 协同机制

#### 基础协同
```swift
// 相邻相同类型符号增加收益
实际收益 = 基础收益 + 相邻同类型符号数量
```

**示例:**
```
[🍎][🍌][🍎] - 中间香蕉相邻2个水果
香蕉收益 = 2 (基础) + 2 (协同) = 4 金币
```

#### 未来扩展协同
- **花流**: 花 + 蜜蜂 + 雨水 = 倍率加成
- **扑克流**: 集齐四种花色 = 特殊奖励
- **水果流**: 特定水果组合 = 永久加成

### 2.4 房租系统

#### 房租计算公式
```swift
房租(n) = 初始房租 × (递增倍率 ^ (n-1))

初始房租 = 50 金币
递增倍率 = 1.5

回合1: 50 金币
回合2: 75 金币
回合3: 112 金币
回合4: 168 金币
回合5: 252 金币
...
```

#### 支付机制
- 每回合10次旋转后结算
- 金币 ≥ 房租 → 进入下一回合
- 金币 < 房租 → 游戏结束

### 2.5 符号选择系统

#### 选择时机
- 成功支付房租后
- 每回合1次选择机会

#### 选择规则
- 随机生成3个符号选项
- 玩家选择1个加入符号池
- 符号稀有度基于权重随机

#### 选择策略
```
早期: 选择稳定基础符号
中期: 根据流派选择协同符号
后期: 选择高收益稀有符号
```

## 三、游戏流程

### 3.1 完整流程图
```
开始游戏
  ↓
初始化（10金币，3个基础符号）
  ↓
┌─────────────────┐
│  旋转阶段        │
│  - 10次旋转      │
│  - 积累金币      │
└────────┬────────┘
         ↓
┌─────────────────┐
│  房租结算        │
│  - 检查金币      │
└────────┬────────┘
         ↓
     是否足够？
    ┌────┴────┐
   否          是
    ↓          ↓
游戏结束   符号选择
            ↓
        进入下一回合
            ↓
        （循环）
```

### 3.2 游戏阶段状态机

```swift
enum GamePhase {
    case selectingSymbol  // 选择符号
    case spinning         // 旋转中
    case result           // 结果展示
    case payingRent       // 支付房租
    case gameOver         // 游戏结束
}
```

### 3.3 单回合流程

**Phase 1: 旋转阶段** (约10-15秒)
1. 显示当前回合信息
2. 执行10次自动旋转
3. 每次旋转显示收益
4. 累计总金币

**Phase 2: 房租结算** (约2秒)
1. 显示房租金额
2. 扣除房租金额
3. 判断是否成功

**Phase 3: 符号选择** (玩家决策)
1. 展示3个随机符号
2. 显示符号详细信息
3. 玩家选择1个
4. 加入符号池

**Phase 4: 下一回合**
1. 回合数+1
2. 房租递增
3. 重置旋转次数
4. 返回Phase 1

## 四、数值平衡

### 4.1 收益预期

#### 初期（回合1-3）
```
符号池: 3-5个符号
平均每格收益: 2-3 金币
单次旋转收益: 40-60 金币
10次旋转总收益: 400-600 金币
房租需求: 50-112 金币
结余: 约300-500 金币
```

#### 中期（回合4-7）
```
符号池: 6-9个符号
平均每格收益: 3-5 金币
单次旋转收益: 60-100 金币
10次旋转总收益: 600-1000 金币
房租需求: 168-632 金币
结余: 约300-400 金币
```

#### 后期（回合8+）
```
符号池: 10+个符号
平均每格收益: 5-8 金币
单次旋转收益: 100-160 金币
10次旋转总收益: 1000-1600 金币
房租需求: 948+ 金币
挑战: 需要高效符号组合
```

### 4.2 平衡目标
- 平均存活回合: 5-7 回合
- 高手目标: 10+ 回合
- 单局游戏时长: 3-5 分钟

## 五、UI/UX设计

### 5.1 界面布局

```
┌─────────────────────────────┐
│  💰 金币   🏠 房租   回合 N  │ ← 顶部信息栏
├─────────────────────────────┤
│                             │
│     💵 本轮获得: XXX 金币    │ ← 收益提示
│                             │
│  ┌───────────────────────┐  │
│  │  🎰  老虎机区域        │  │
│  │  [5×4格子布局]        │  │ ← 老虎机主体
│  │                       │  │
│  └───────────────────────┘  │
│                             │
│  ╔═══════════════════════╗  │
│  ║  我的符号池 (N种)      ║  │ ← 符号池展示
│  ║  [🍎][🍌][💰][🐝]...  ║  │
│  ╚═══════════════════════╝  │
│                             │
└─────────────────────────────┘
```

### 5.2 视觉风格
- **色调**: 温暖明亮的渐变色
- **风格**: 扁平化设计 + 圆角元素
- **图标**: Emoji符号（简洁直观）
- **动画**: 流畅的过渡效果

### 5.3 交互反馈
- 旋转动画（360度旋转）
- 金币增加动画
- 符号选择高亮效果
- 房租支付成功/失败提示

## 六、技术实现

### 6.1 架构设计

```
┌─────────────────────────────────┐
│         A004App (入口)           │
└────────────┬────────────────────┘
             ↓
┌─────────────────────────────────┐
│       ContentView (根视图)       │
└────────────┬────────────────────┘
             ↓
┌─────────────────────────────────┐
│      GameView (游戏主界面)       │
│  ┌─────────────────────────┐   │
│  │   GameViewModel (MVVM)  │←─┤
│  └─────────────────────────┘   │
└─────────────────────────────────┘
             ↓
┌─────────────────────────────────┐
│         Models (数据层)          │
│  - Symbol (符号模型)             │
│  - Item (道具模型)               │
│  - GameState (游戏状态)          │
│  - SymbolLibrary (符号库)        │
└─────────────────────────────────┘
```

### 6.2 核心类设计

**GameViewModel (游戏控制器)**
```swift
class GameViewModel: ObservableObject {
    // 状态
    @Published var currentCoins: Int
    @Published var currentRound: Int
    @Published var rentAmount: Int
    @Published var gamePhase: GamePhase
    
    // 符号池
    @Published var symbolPool: [Symbol]
    @Published var slotMachine: [SlotCell]
    
    // 方法
    func spin()                        // 旋转
    func calculateEarnings()           // 计算收益
    func checkRentPayment()            // 检查房租
    func selectSymbol(_ symbol: Symbol) // 选择符号
    func startNewGame()                // 新游戏
}
```

**Symbol (符号模型)**
```swift
struct Symbol: Identifiable, Codable {
    let id: UUID
    let name: String
    let icon: String
    let baseValue: Int
    let rarity: SymbolRarity
    let type: SymbolType
    
    func calculateValue(adjacentSymbols: [Symbol]) -> Int
}
```

### 6.3 数据持久化（未来）
```swift
struct GameSave: Codable {
    let currentCoins: Int
    let currentRound: Int
    let symbolPool: [Symbol]
    let highScore: Int
    let playCount: Int
}
```

## 七、后续开发计划

### 7.1 Version 1.1 - 体验优化
- [ ] 添加音效（旋转、收益、房租）
- [ ] 增强动画效果
- [ ] 触觉反馈支持
- [ ] 数值平衡调整

### 7.2 Version 1.2 - 内容扩展
- [ ] 新增20个符号
- [ ] 实现道具系统（10种道具）
- [ ] 添加特殊事件
- [ ] 符号进阶效果

### 7.3 Version 2.0 - 深度系统
- [ ] 多流派构筑系统
- [ ] 成就系统（30个成就）
- [ ] 每日挑战模式
- [ ] 排行榜功能
- [ ] iCloud存档同步

### 7.4 Version 2.5 - 高级功能
- [ ] 自定义符号编辑器
- [ ] 关卡模式
- [ ] 多人对战（异步）
- [ ] 符号皮肤系统

## 八、参考资料

### 8.1 原版游戏特色
- 符号种类丰富（100+种）
- 深度的协同机制
- 多样的流派构筑
- Roguelike随机性

### 8.2 我们的差异化
- 移动端优化的UI
- 简化的符号系统
- 快节奏的游戏体验
- 适合碎片化时间

### 8.3 设计理念
> "易于上手，难于精通"
> "每局5分钟，充满策略深度"
> "简单的机制，无限的可能"

---
ID	name	free	buff
1	勇者哥布林	yes	每有一个符号被消除，则+1金币
2	工匠哥布林	yes	每回合增加一次获得符号3选1的机会
3	赌徒哥布林	yes	挖到骰子概率翻倍
4	国王哥布林	no	每有一个士兵，额外获得10金币
5	巫师哥布林	no	每回合挖矿之前随机填充1个魔法袋




**文档版本**: v1.0  
**最后更新**: 2025年9月30日  
**状态**: 核心功能已实现 ✅
